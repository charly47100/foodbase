<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://apis.google.com/js/api.js"></script>
<script>
  // Client ID and API key from the Developer Console
  var CLIENT_ID = 'YOUR_CLIENT_ID';
  var API_KEY = 'YOUR_API_KEY';

  // Array of API discovery doc URLs for APIs used by the quickstart
  var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

  // Authorization scopes required by the API; multiple scopes can be
  // included, separated by spaces.
  var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

  // Load the API client and sign-in the user
  function handleClientLoad() {
    gapi.load('client:auth2', initClient);
  }

  function initClient() {
    gapi.client.init({
      apiKey: API_KEY,
      clientId: CLIENT_ID,
      discoveryDocs: DISCOVERY_DOCS,
      scope: SCOPES
    }).then(function() {
      // Sign in the user if required
      if (!gapi.auth2.getAuthInstance().isSignedIn.get()) {
        gapi.auth2.getAuthInstance().signIn();
      }
    }, function(error) {
      console.log(JSON.stringify(error, null, 2));
    });
  }

  $(document).ready(function() {
    // Load the data from the Google Sheet
    gapi.client.load('sheets', 'v4', function() {
      var request = gapi.client.sheets.spreadsheets.values.get({
        spreadsheetId: 'YOUR_SPREADSHEET_ID',
        range: 'Sheet1'
      });
      request.then(function(response) {
        var rows = response.result.values;
        var table = $('#data-table');
        rows.forEach(function(row) {
          var tr = $('<tr>');
          row.forEach(function(column) {
            var td = $('<td>').text(column);
            tr.append(td);
          });
          table.append(tr);
        });
      }, function(reason) {
        console.error('Error: ' + reason.result.error.message);
      });
    });
  });
</script>
